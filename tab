public boolean sendEmailWithTemplate(String to, String templateName, Map<String, Object> variables) {
    try {
        Template template = freemarkerConfig.getTemplate(templateName);
        StringWriter out = new StringWriter();
        template.process(variables, out);
        String html = out.toString();

        MimeMessage mime = javaMailSender.createMimeMessage();
        MimeMessageHelper helper = new MimeMessageHelper(
                mime,
                MimeMessageHelper.MULTIPART_MODE_MIXED_RELATED,
                StandardCharsets.UTF_8.name()
        );

        helper.setTo(to);
        helper.setFrom("noreply@ton-domaine.com");
        helper.setSubject(String.valueOf(variables.getOrDefault("subject",
                "R2D2 â€“ Notification")));
        helper.setText(html, true); // <<<< HTML

        javaMailSender.send(mime);
        return true;
    } catch (TemplateException | IOException e) {
        throw new RuntimeException(e);
    }
}
